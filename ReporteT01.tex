% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={ReporteT01},
  pdfauthor={Axel R},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{ReporteT01}
\author{Axel R}
\date{2023-02-10}

\begin{document}
\maketitle

\hypertarget{practica-archivo-bam}{%
\section{Practica archivo BAM}\label{practica-archivo-bam}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Entrar a un qlogin}
\ExtensionTok{qlogin}
\CommentTok{\# Entrar a la carpeta donde se encuentra el archivp}
\BuiltInTok{cd}\NormalTok{ /mnt/Timina/bioinfoII/format\_qc}
\CommentTok{\# Se copia el archivo a la caarpeta donde se estara trabajando trabajando}
\FunctionTok{cp}\NormalTok{ NA20538.bam /mnt/Timina/bioinfoII/arodriguez}
\CommentTok{\# Dirigirse a la carpeta donde se trabaja}
\end{Highlighting}
\end{Shaded}

\hypertarget{practica-bfc}{%
\section{Practica bfc}\label{practica-bfc}}

\hypertarget{practica-estadisticas}{%
\section{Practica estadisticas}\label{practica-estadisticas}}

\hypertarget{what-is-the-total-number-of-reads}{%
\subsection{What is the total number of
reads?}\label{what-is-the-total-number-of-reads}}

Usando el comando \texttt{samtools\ flagstat} se puede observar las
estadisticas generales del archivo BAM. Si lo que se requiere saber es
el \textbf{numero total de lecturas}, entonces se utiliza el comando:

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{samtools}\NormalTok{ flagstat NA20538.bam }\KeywordTok{|} \FunctionTok{head} \AttributeTok{{-}n}\NormalTok{ 1}
\end{Highlighting}
\end{Shaded}

En donde el comando \texttt{head\ -n\ 1} funciona para imprimir solo la
primera linea del output, donde se encuentran el numero de lecturas
totales.

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{347367}\NormalTok{ + 0 in total }\ErrorTok{(}\ExtensionTok{QC{-}passed}\NormalTok{ reads + QC{-}failed reads}\KeywordTok{)}
\end{Highlighting}
\end{Shaded}

Como se observa, el numero de \emph{reads} totales fue de
\textbf{347,367}.

\hypertarget{otras-alternativas}{%
\subsubsection{Otras alternativas}\label{otras-alternativas}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Estadisticas generales}
\ExtensionTok{samtools}\NormalTok{ flagstat NA20538.bam}
\CommentTok{\# Lecturas totales ejemplo 2}
\ExtensionTok{samtools}\NormalTok{ view }\AttributeTok{{-}c}\NormalTok{ NA20538.bam }\CommentTok{\# 347367}
\CommentTok{\# Lecturas totales ejemplo 3}
\ExtensionTok{samtools}\NormalTok{ stats NA20538.bam }\KeywordTok{|} \FunctionTok{grep} \StringTok{\textquotesingle{}SN\textquotesingle{}} \KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}f}\NormalTok{ 2{-} }\CommentTok{\# 347367}
\CommentTok{\# Lecturas totales ejemplo 4}
\ExtensionTok{samtools}\NormalTok{ stats NA20538.bam }\KeywordTok{|} \FunctionTok{grep} \StringTok{\textquotesingle{}raw total sequences\textquotesingle{}} \KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}f}\NormalTok{ 2{-} }\CommentTok{\# 347367}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  \texttt{view\ -c} cuenta los alineamientos e imprime el total.
\item
  \texttt{samtools\ stats} muestra estadÃ­sticas relevantes sobre cada
  lane y grupo de lectura, asÃ­ como informaciÃ³n sobre las secuencias.
\item
  \texttt{grep} busca e imprime las lineas coincidentes con un patron
  (en el ej.3 \texttt{â€˜SNâ€™})
\item
  La seccin \texttt{SN} del comando \texttt{samtools\ stats} brinda un
  resumen con conteos, porcentajes y promedios, en un estilo similar al
  de \texttt{samtools\ flagstat}, pero mÃ¡s completo.
\item
  \texttt{cut} se utiliza para seleccionar una columna del output. Con
  el parametro \texttt{-f\ 2-} le indicamos que solo queremos las
  ultimas dos columnas del output.
\item
  \texttt{grep\ \textquotesingle{}raw\ total\ sequences\textquotesingle{}}
  se utiliza para especificar que solo se requieren el total de
  lecturas, lo que nos da un output mas ordenado.
\end{itemize}

\hypertarget{what-proportion-of-the-reads-were-mapped}{%
\subsection{What proportion of the reads were
mapped?}\label{what-proportion-of-the-reads-were-mapped}}

Con el mismo comando de \texttt{samtools\ flagstat\ NA20538.bam}, se
observa que el porcentaje de *****reads***** mapeados fue de
\textbf{93.26\%} (323,966 lecturas).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Filtramos los resultados que coincidan con \textquotesingle{}mapped\textquotesingle{} e imprimimos}
\CommentTok{\# todos los argumentos de la primera fila}
\ExtensionTok{samtools}\NormalTok{ flagstat NA20538.bam }\KeywordTok{|} \FunctionTok{grep} \StringTok{\textquotesingle{}mapped\textquotesingle{}}\KeywordTok{|} \FunctionTok{awk} \StringTok{\textquotesingle{}\{print $0\}\textquotesingle{}}\KeywordTok{|} \FunctionTok{head} \AttributeTok{{-}n}\NormalTok{ 1}
\ExtensionTok{323966}\NormalTok{ + 0 mapped }\ErrorTok{(}\ExtensionTok{93.26\%}\NormalTok{ : N/A}\KeywordTok{)}
\end{Highlighting}
\end{Shaded}

El comando
\texttt{awk\ \textquotesingle{}\{print\ \$0\}\textquotesingle{}}
imprimir la primera fila del output del comando
\texttt{samtools\ flagstat\ NA20538.bam\ \textbar{}\ grep\ \textquotesingle{}mapped\textquotesingle{}}.

ðŸ“Œ Generalmente
\texttt{awk\ \textquotesingle{}\{print\ \$n\}\textquotesingle{}} es
utilizado para imprimir la \(n\)-esima columna de un output.
\texttt{awk\ â€˜NR==m\ \{print\ \$n\}â€™} se utiliza para imprimir la
\(m\)-esima fila y la \(n\)-esima columna.

\hypertarget{otras-alternativas-1}{%
\subsubsection{Otras alternativas}\label{otras-alternativas-1}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Lecturas mapeadas (Mapped alignments)}

\CommentTok{\#\# Ejemplo 2}
\ExtensionTok{samtools}\NormalTok{ view }\AttributeTok{{-}F}\NormalTok{ 0x904 }\AttributeTok{{-}c}\NormalTok{ NA20538.bam }\CommentTok{\# 323966}
\CommentTok{\#\# Ejemplo 3}
\ExtensionTok{samtools}\NormalTok{ view }\AttributeTok{{-}c} \AttributeTok{{-}F}\NormalTok{ 260 NA20538.bam }\CommentTok{\# \# 323966}
\CommentTok{\#\# Ejemplo 4}
\ExtensionTok{samtools}\NormalTok{ view }\AttributeTok{{-}F}\NormalTok{ 0x04 }\AttributeTok{{-}c}\NormalTok{ NA20538.bam }\CommentTok{\# 323966}
\CommentTok{\#\# Ejemplo 5}
\ExtensionTok{samtools}\NormalTok{ stats NA20538.bam }\KeywordTok{|} \FunctionTok{grep} \StringTok{\textquotesingle{}SN\textquotesingle{}} \KeywordTok{|} \FunctionTok{grep} \StringTok{\textquotesingle{}reads mapped\textquotesingle{}} \KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}f}\NormalTok{ 2{-} }\CommentTok{\#323966}
\end{Highlighting}
\end{Shaded}

\hypertarget{how-many-reads-were-mapped-to-a-different-chromosome}{%
\subsection{How many reads were mapped to a different
chromosome?}\label{how-many-reads-were-mapped-to-a-different-chromosome}}

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{samtools}\NormalTok{ stats NA20538.bam }\KeywordTok{|} \FunctionTok{grep} \StringTok{\textquotesingle{}pairs on different chromosomes:\textquotesingle{}} \KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}f}\NormalTok{ 2{-}}
\end{Highlighting}
\end{Shaded}

De acuerdo a la seccion \texttt{SN} del archivo, \textbf{4,055} lecturas
fueron mapeadas a un cromosoma diferente.

\hypertarget{what-is-the-insert-size-mean-and-standard-deviation}{%
\subsection{What is the insert size mean and standard
deviation?}\label{what-is-the-insert-size-mean-and-standard-deviation}}

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{samtools}\NormalTok{ stats }\AttributeTok{{-}F}\NormalTok{ SECONDARY NA20538.bam }\KeywordTok{|} \FunctionTok{grep} \StringTok{"insert size"} \KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}f}\NormalTok{ 2{-}}
\end{Highlighting}
\end{Shaded}

Finalmente, en la seccion de Sumary Numbers (\texttt{SN}) generada por
\texttt{samtools\ stats} se encuentra la informaciÃ³n requerida.

\begin{itemize}
\tightlist
\item
  insert size average: \textbf{190.3}
\item
  insert size standard deviation: \textbf{136.4}
\end{itemize}

\end{document}
